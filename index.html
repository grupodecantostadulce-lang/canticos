<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CÃ¢nticos - Santa Dulce</title>
    <style>
        :root { --blue: #0056b3; --bg: #f4f7f6; --text: #333; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; background: var(--bg); color: var(--text); }
        header { background: var(--blue); color: white; padding: 2rem 1rem; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        
        .container { max-width: 800px; margin: 20px auto; padding: 0 20px; }
        
        /* Estilo dos Filtros */
        .filter-container { 
            background: white; padding: 20px; border-radius: 12px; 
            margin-bottom: 25px; display: flex; gap: 10px; flex-wrap: wrap;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        select, input { 
            padding: 12px; border: 1px solid #ddd; border-radius: 8px; 
            flex: 1; min-width: 140px; font-size: 16px; outline: none;
        }
        select:focus { border-color: var(--blue); }

        /* Estilo dos Meses e Cards */
        .month-group { margin-top: 30px; }
        .month-title { 
            color: var(--blue); border-bottom: 2px solid var(--blue); 
            padding-bottom: 5px; margin-bottom: 15px; text-transform: uppercase;
            font-size: 1.2rem; letter-spacing: 1px;
        }
        
        .item-link { text-decoration: none; color: inherit; display: block; margin-bottom: 10px; }
        .item { 
            background: white; padding: 16px; border-radius: 8px; 
            border-left: 5px solid #00c853; /* Verde para indicar arquivo */
            display: flex; justify-content: space-between; align-items: center; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.05); transition: 0.2s;
        }
        .item:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        
        .btn-view { color: var(--blue); font-weight: bold; font-size: 14px; }
        .date-badge { color: #777; font-size: 13px; display: block; margin-top: 4px; }
        
        #loading { text-align: center; padding: 40px; color: #666; font-style: italic; }
        #no-results { text-align: center; padding: 40px; color: #999; display: none; }

        img {
          max-width: 100%; /* A imagem nunca serÃ¡ maior que seu contÃªiner */
          height: auto;    /* A altura se ajusta automaticamente */
        }
    </style>
</head>
<body>

<header>
    <img src="imagens/pastoral mÃºsica.png" alt="">
    <img src="imagens/stadulce preview.png" alt="">
    <h1>CÃ¢nticos - Sta. Dulce dos Pobres</h1>
    <p>Selecione o ano e mÃªs para ver o repertÃ³rio</p>
</header>

<div class="container">
    <div class="filter-container">
        <select id="yearFilter" onchange="filterAndRender()">
            <option value="">Todos os Anos</option>
            <option value="2024">2024</option>
            <option value="2025">2025</option>
            <option value="2026">2026</option>
        </select>

        <select id="monthFilter" onchange="filterAndRender()">
            <option value="">Todos os Meses</option>
            <option value="01">Janeiro</option>
            <option value="02">Fevereiro</option>
            <option value="03">MarÃ§o</option>
            <option value="04">Abril</option>
            <option value="05">Maio</option>
            <option value="06">Junho</option>
            <option value="07">Julho</option>
            <option value="08">Agosto</option>
            <option value="09">Setembro</option>
            <option value="10">Outubro</option>
            <option value="11">Novembro</option>
            <option value="12">Dezembro</option>
        </select>
    </div>

    <div id="loading">Buscando documentos na nuvem...</div>
    <div id="no-results">Nenhum cÃ¢ntico encontrado para este perÃ­odo.</div>
    <div id="fileList"></div>
</div>

<script>
    // === CONFIGURAÃ‡ÃƒO (AJUSTE COM SEUS DADOS) ===
    const GITHUB_USER = 'grupodecantostadulce-lang'; 
    const REPO_NAME = 'canticos';
    const FOLDER_PATH = 'arquivos'; 

    let allFiles = [];
    const monthNames = {
        "01": "Janeiro", "02": "Fevereiro", "03": "MarÃ§o", "04": "Abril",
        "05": "Maio", "06": "Junho", "07": "Julho", "08": "Agosto",
        "09": "Setembro", "10": "Outubro", "11": "Novembro", "12": "Dezembro"
    };

    async function fetchFiles() {
        const url = `https://api.github.com/repos/${GITHUB_USER}/${REPO_NAME}/contents/${FOLDER_PATH}`;
        try {
            const response = await fetch(url);
            const data = await response.json();
            
            allFiles = data.map(file => {
                const parts = file.name.split('_'); // Espera: 2025-01-20_Nome.pdf
                const fullDate = parts[0]; 
                const dateParts = fullDate.split('-');
                
                return {
                    name: file.name,
                    rawUrl: `https://raw.githubusercontent.com/${GITHUB_USER}/${REPO_NAME}/main/${FOLDER_PATH}/${file.name}`,
                    year: dateParts[0],
                    month: dateParts[1],
                    day: dateParts[2],
                    title: parts[1] ? parts[1].replace(/-/g, ' ').split('.')[0] : file.name
                };
            }).sort((a, b) => b.name.localeCompare(a.name)); // Ordena do mais recente para o mais antigo

            document.getElementById('loading').style.display = 'none';
            filterAndRender();
        } catch (e) {
            document.getElementById('loading').innerText = "Erro ao carregar arquivos do GitHub.";
        }
    }

    function filterAndRender() {
        const selYear = document.getElementById('yearFilter').value;
        const selMonth = document.getElementById('monthFilter').value;
        const listDiv = document.getElementById('fileList');
        const noResults = document.getElementById('no-results');
        
        listDiv.innerHTML = '';

        // Filtra os arquivos
        const filtered = allFiles.filter(f => {
            const matchYear = selYear ? f.year === selYear : true;
            const matchMonth = selMonth ? f.month === selMonth : true;
            return matchYear && matchMonth;
        });

        if (filtered.length === 0) {
            noResults.style.display = 'block';
            return;
        }
        noResults.style.display = 'none';

        // LÃ³gica de agrupamento por mÃªs
        let currentMonth = "";

        filtered.forEach(file => {
            // Se o mÃªs mudar, cria um novo cabeÃ§alho de tÃ­tulo de mÃªs
            if (file.month !== currentMonth) {
                currentMonth = file.month;
                const monthHead = document.createElement('div');
                monthHead.className = 'month-group';
                monthHead.innerHTML = `<h2 class="month-title">${monthNames[file.month] || 'Outros'} ${file.year}</h2>`;
                listDiv.appendChild(monthHead);
            }

            const viewUrl = `https://docs.google.com/viewer?url=${encodeURIComponent(file.rawUrl)}&embedded=true`;
            
            const anchor = document.createElement('a');
            anchor.className = 'item-link';
            anchor.href = viewUrl;
            anchor.target = '_blank';

            anchor.innerHTML = `
                <div class="item">
                    <div>
                        <strong>${file.title}</strong>
                        <span class="date-badge">ðŸ“… ${file.day}/${file.month}/${file.year}</span>
                    </div>
                    <span class="btn-view">VER âž”</span>
                </div>
            `;
            listDiv.appendChild(anchor);
        });
    }

    fetchFiles();
</script>

</body>

</html>
