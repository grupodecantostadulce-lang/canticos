<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¢nticos - Santa Dulce</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
    <div class="header-content">
        <img src="imagens/pastoral m√∫sica.png" class="header-logo" alt="Pastoral da M√∫sica">
        
        <div class="header-text">
            <h1>√Årea Mission√°ria Santa Dulce dos Pobres</h1>
            <p>Portal da Pastoral da M√∫sica</p>
            <h2>CIFRAS EM FORMATO TEXTO - MISSAS</h2>
        </div>
        <img src="imagens/stadulce preview.png" class="header-logo" alt="Santa Dulce">
    </div>
</header>

<div class="nav-container">
    <nav class="menu-horizontal">
        <a href="index.html" class="nav-link"><span>üìÑ</span> INICIO</a>
        <a href="cifra.html" class="nav-link"><span>üé∏</span> CIFRAS PDF</a>
        <a href="letras.html" class="nav-link"><span>üé∂</span> LETRAS TEXTO</a>
        <a href="diversos.html" class="nav-link"><span>üé§</span> C√ÇNTICOS DIVERSOS</a>
    </nav>
</div>

<div class="container">
    <div class="filter-container">
        <p>Selecione o ano e m√™s para ver o repert√≥rio</p>  
        <select id="yearFilter" onchange="filterAndRender()">
            <option value="">Todos os Anos</option>
            <option value="2024">2024</option>
            <option value="2025">2025</option>
            <option value="2026">2026</option>
        </select>

        <select id="monthFilter" onchange="filterAndRender()">
            <option value="">Todos os Meses</option>
            <option value="01">Janeiro</option>
            <option value="02">Fevereiro</option>
            <option value="03">Mar√ßo</option>
            <option value="04">Abril</option>
            <option value="05">Maio</option>
            <option value="06">Junho</option>
            <option value="07">Julho</option>
            <option value="08">Agosto</option>
            <option value="09">Setembro</option>
            <option value="10">Outubro</option>
            <option value="11">Novembro</option>
            <option value="12">Dezembro</option>
        </select>
    </div>

    <div id="loading">Buscando documentos na nuvem...</div>
    <div id="no-results">Nenhum c√¢ntico encontrado para este per√≠odo.</div>
    <div id="fileList"></div>
</div>

<footer>
    <strong>√Årea Mission√°ria Santa Dulce dos Pobres</strong>
    <div class="footer-info">
        Pastoral da M√∫sica<br>
        ¬© 2026 - Todos os arquivos s√£o para uso celebrativo.
    </div>
</footer>

<script>
    // === CONFIGURA√á√ÉO (AJUSTE COM SEUS DADOS) ===
    const GITHUB_USER = 'grupodecantostadulce-lang'; 
    const REPO_NAME = 'canticos';
    const FOLDER_PATH = 'texto_cifras'; 

    let allFiles = [];
    const monthNames = {
        "01": "Janeiro", "02": "Fevereiro", "03": "Mar√ßo", "04": "Abril",
        "05": "Maio", "06": "Junho", "07": "Julho", "08": "Agosto",
        "09": "Setembro", "10": "Outubro", "11": "Novembro", "12": "Dezembro"
    };

    async function fetchFiles() {
        const url = `https://api.github.com/repos/${GITHUB_USER}/${REPO_NAME}/contents/${FOLDER_PATH}`;
        try {
            const response = await fetch(url);
            const data = await response.json();
            
            allFiles = data.map(file => {
                const parts = file.name.split('_'); // Espera: 2025-01-20_Nome.pdf
                const fullDate = parts[0]; 
                const dateParts = fullDate.split('-');
                
                return {
                    name: file.name,
                    rawUrl: `https://raw.githubusercontent.com/${GITHUB_USER}/${REPO_NAME}/main/${FOLDER_PATH}/${file.name}`,
                    year: dateParts[0],
                    month: dateParts[1],
                    day: dateParts[2],
                    title: parts[1] ? parts[1].replace(/-/g, ' ').split('.')[0] : file.name
                };
            }).sort((a, b) => b.name.localeCompare(a.name)); // Ordena do mais recente para o mais antigo

            document.getElementById('loading').style.display = 'none';
            filterAndRender();
        } catch (e) {
            document.getElementById('loading').innerText = "Erro ao carregar arquivos do GitHub.";
        }
    }

    function filterAndRender() {
        const selYear = document.getElementById('yearFilter').value;
        const selMonth = document.getElementById('monthFilter').value;
        const listDiv = document.getElementById('fileList');
        const noResults = document.getElementById('no-results');
        
        listDiv.innerHTML = '';

        // Filtra os arquivos
        const filtered = allFiles.filter(f => {
            const matchYear = selYear ? f.year === selYear : true;
            const matchMonth = selMonth ? f.month === selMonth : true;
            return matchYear && matchMonth;
        });

        if (filtered.length === 0) {
            noResults.style.display = 'block';
            return;
        }
        noResults.style.display = 'none';

        // L√≥gica de agrupamento por m√™s
        let currentMonth = "";

        filtered.forEach(file => {
            // Se o m√™s mudar, cria um novo cabe√ßalho de t√≠tulo de m√™s
            if (file.month !== currentMonth) {
                currentMonth = file.month;
                const monthHead = document.createElement('div');
                monthHead.className = 'month-group';
                monthHead.innerHTML = `<h2 class="month-title">${monthNames[file.month] || 'Outros'} ${file.year}</h2>`;
                listDiv.appendChild(monthHead);
            }

            const viewUrl = `https://docs.google.com/viewer?url=${encodeURIComponent(file.rawUrl)}&embedded=true`;
            
            const anchor = document.createElement('a');
            anchor.className = 'item-link';
            anchor.href = viewUrl;
            anchor.target = '_blank';

            anchor.innerHTML = `
                <div class="item">
                    <div>
                        <strong>${file.title}</strong>
                        <span class="date-badge">üìÖ ${file.day}/${file.month}/${file.year}</span>
                    </div>
                    <span class="btn-view">VER ‚ûî</span>
                </div>
            `;
            listDiv.appendChild(anchor);
        });
    }

    fetchFiles();
</script>

</body>

</html>


